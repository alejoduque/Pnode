#N canvas 339 128 1094 756 10;
#X obj 36 40 loadbang;
#X obj 36 151 readsf~ 1;
#X obj 559 222 tab_rmstodb \$0-fft \$0-fftdb;
#X obj 542 348 tab_mul_scalar \$0-fftdb \$0-fftdb;
#X obj 36 62 f \$1;
#X msg 36 103 open /home/uchronies/radiographie/data/rec\$1.aiff \,
start;
#X obj 508 188 t b b b b;
#X obj 491 16 table \$0-fft 128;
#X obj 490 35 table \$0-fftdb 128;
#N canvas 447 152 897 747 draw 0;
#X obj 234 110 GEMglEnd;
#X obj 332 96 GEMglShadeModel GL_SMOOTH;
#X obj 234 133 GEMglShadeModel GL_FLAT;
#X obj 253 305 gemlist;
#X obj 253 222 until;
#X obj 308 287 f;
#X obj 343 286 + 1;
#X obj 332 118 GEMglBegin GL_QUAD_STRIP;
#X obj 405 574 r \$0-speed;
#X obj 234 63 t a b a a;
#X obj 253 167 t b b b;
#X obj 253 247 t b b;
#X obj 672 453 tabread x_fft;
#X obj 757 452 tabread x_fft;
#X obj 405 632 - 3.98;
#X obj 405 605 / 1000;
#X msg 428 672 -3;
#X obj 380 493 r disp_power;
#X obj 369 524 r disp_scale;
#X obj 688 348 f \$1;
#X obj 688 370 * 200;
#X obj 409 186 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 234 42 alpha 1;
#X obj 600 582 f;
#X floatatom 600 613 10 0 0 0 - - -;
#X obj 653 569 f;
#X floatatom 653 591 10 0 0 0 - - -;
#X obj 600 550 min 10;
#X obj 84 14 r gemhead511;
#X obj 253 614 GEMglVertex3f 0 -4 0;
#X obj 253 640 GEMglVertex3f 0 -4 0;
#X obj 253 667 GEMglVertex3f 0 -3.98 0;
#X obj 253 693 GEMglVertex3f 0 -3.98 0;
#X obj 448 180 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 498 528 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg 318 238 0;
#X obj 687 410 +;
#X obj 467 216 loadbang;
#X obj 751 402 + 1;
#X obj 653 547 max -1e+07;
#X obj 598 522 f;
#X obj 253 589 GEMglColor4f 0 1 0 0.5;
#X obj 665 14 inlet;
#X obj 308 499 pow 4;
#X obj 308 530 * 14;
#X obj 200 440 print;
#X floatatom 619 151 5 0 0 0 - - -;
#X msg 619 63 6.36;
#X obj 635 125 / 4;
#X obj 308 340 tabread \$0-fftfin;
#X obj 689 65 inlet;
#X obj 687 390 +;
#X obj 758 238 inlet;
#X obj 370 61 scaleXYZ 1 1 1;
#X obj 759 266 * 10;
#X floatatom 421 458 5 0 0 0 - - -;
#X floatatom 476 493 5 0 0 0 - - -;
#X obj 381 254 == 63;
#X obj 381 276 sel 1;
#X obj 253 198 f 32;
#X obj 531 165 tabread x_fft;
#X obj 531 76 f \$1;
#X obj 531 98 * 200;
#X obj 531 32 loadbang;
#X obj 531 138 +;
#X obj 334 33 translateXYZ 0 0 0;
#X obj 531 54 delay 10;
#X obj 666 433 + 1039;
#X obj 740 428 + 1040;
#X obj 664 48 t b f;
#X obj 689 91 t b f;
#X obj 466 420 / 2048;
#X obj 466 398 * 8;
#X obj 521 452 / 2048;
#X obj 521 430 * 8;
#X obj 519 402 + 1;
#X obj 316 169 separator;
#X obj 55 69 loadbang;
#X msg 55 91 0;
#X obj 55 113 gemhead;
#X obj 84 36 t b;
#X connect 0 0 2 0;
#X connect 1 0 7 0;
#X connect 3 0 41 0;
#X connect 4 0 11 0;
#X connect 5 0 6 0;
#X connect 5 0 49 0;
#X connect 5 0 57 0;
#X connect 5 0 67 0;
#X connect 5 0 68 0;
#X connect 5 0 72 0;
#X connect 5 0 75 0;
#X connect 6 0 5 1;
#X connect 8 0 15 0;
#X connect 9 0 0 0;
#X connect 9 1 10 0;
#X connect 9 2 1 0;
#X connect 9 3 65 0;
#X connect 10 0 59 0;
#X connect 10 2 19 0;
#X connect 10 2 35 0;
#X connect 11 0 3 0;
#X connect 11 1 5 0;
#X connect 14 0 31 2;
#X connect 14 0 32 2;
#X connect 15 0 14 0;
#X connect 16 0 31 2;
#X connect 16 0 32 2;
#X connect 17 0 43 1;
#X connect 18 0 44 1;
#X connect 20 0 51 0;
#X connect 21 0 19 0;
#X connect 22 0 9 0;
#X connect 23 0 24 0;
#X connect 23 0 27 1;
#X connect 25 0 26 0;
#X connect 25 0 39 1;
#X connect 27 0 23 0;
#X connect 28 0 80 0;
#X connect 29 0 30 0;
#X connect 30 0 31 0;
#X connect 31 0 32 0;
#X connect 35 0 5 1;
#X connect 36 0 38 0;
#X connect 36 0 12 0;
#X connect 38 0 13 0;
#X connect 39 0 25 0;
#X connect 40 0 27 0;
#X connect 40 0 39 0;
#X connect 41 0 29 0;
#X connect 42 0 20 1;
#X connect 42 0 69 0;
#X connect 43 0 44 0;
#X connect 44 0 41 1;
#X connect 44 0 41 2;
#X connect 44 0 41 3;
#X connect 47 0 48 0;
#X connect 48 0 46 0;
#X connect 49 0 43 0;
#X connect 50 0 51 1;
#X connect 50 0 70 0;
#X connect 51 0 36 1;
#X connect 52 0 54 0;
#X connect 54 0 53 1;
#X connect 55 0 43 1;
#X connect 56 0 44 1;
#X connect 57 0 58 0;
#X connect 58 0 4 1;
#X connect 59 0 4 0;
#X connect 60 0 65 1;
#X connect 61 0 62 0;
#X connect 62 0 64 0;
#X connect 63 0 66 0;
#X connect 64 0 60 0;
#X connect 65 0 76 0;
#X connect 66 0 61 0;
#X connect 67 0 12 0;
#X connect 68 0 13 0;
#X connect 69 0 61 0;
#X connect 69 1 62 1;
#X connect 70 0 61 0;
#X connect 70 1 64 1;
#X connect 71 0 29 1;
#X connect 71 0 31 1;
#X connect 72 0 71 0;
#X connect 73 0 32 1;
#X connect 73 0 30 1;
#X connect 74 0 73 0;
#X connect 75 0 74 0;
#X connect 76 0 3 1;
#X connect 77 0 78 0;
#X connect 78 0 79 0;
#X connect 79 0 22 0;
#X connect 80 0 79 0;
#X restore 163 621 pd draw;
#X obj 36 531 send~ out\$1;
#X obj 508 163 r sync_fft;
#X obj 508 467 tab_copy \$0-fftdb \$0-fftfin;
#X obj 37 490 *~;
#X obj 64 419 line~;
#X obj 295 644 outlet;
#X obj 295 372 inlet;
#X obj 295 599 list prepend set;
#X floatatom 295 531 5 0 0 0 - - -;
#X obj 295 621 list trim;
#X obj 464 645 tabread x_fft;
#X obj 465 542 f \$1;
#X obj 465 564 * 200;
#X obj 464 618 + 16;
#X obj 465 503 t b f;
#X obj 72 208 r pos_freq_fine;
#X obj 72 234 -;
#X obj 72 257 abs;
#X obj 64 283 moses 0.1;
#X obj 64 315 * 10;
#X floatatom 108 251 5 0 0 0 - - -;
#X floatatom 117 361 5 0 0 0 - - -;
#X msg 64 349 1 \$1;
#X obj 64 371 -;
#X msg 112 315 0 100;
#X obj 64 441 *~;
#X msg 64 396 \$1 50;
#X obj 144 531 send~ outr\$1;
#X obj 143 491 *~;
#X obj 170 420 line~;
#X obj 178 235 -;
#X obj 178 258 abs;
#X obj 170 284 moses 0.1;
#X obj 170 316 * 10;
#X floatatom 229 258 5 0 0 0 - - -;
#X floatatom 223 362 5 0 0 0 - - -;
#X msg 170 350 1 \$1;
#X obj 170 372 -;
#X msg 218 316 0 100;
#X obj 170 442 *~;
#X msg 170 397 \$1 50;
#X obj 178 209 r pos_freq_fine2;
#N canvas 653 239 643 640 fft-analysis 0;
#X obj 15 164 *~;
#X obj 14 49 inlet~;
#X obj 15 218 rfft~;
#X text 85 88 The inlet~ now re-uses 3/4 of the previous block \, along
with the 128 new samples.;
#X text 221 141 window function as before.;
#X text 212 291 divide by 3N/2 (factor of N because rfft and rifft
aren't normalized \, and 3/2 is the gain of overlap-4 reconstruction
when Hann window function is applied twice.);
#X text 234 206 Just to show we're doing something \, we multiply each
channel by a gain controlled by an array in the main window. The control
is quartic-scaled for easy editing.;
#X text 206 347 Multiply the (complex-valued) spectrum amplitudes by
the (real-valued) gain-and-normalization-factor;
#X text 203 386 Real-valued inverse Fourier transform. This uses only
the first N/@ points of its inputs \, supplying the rest by symmerty
(so it's OK that rfft~ obly puts out those N/2 points.) There's only
one outlet because the output is real-valued.;
#X text 202 489 Multiply by the Hann window function again \, necessary
because the operation we performed might result in a signal that doesn't
go smoothly to zero at both ends.;
#X text 203 556 This repackages the output into 64-sample chunks for
the parent window. Since we're operating with an overlap \, the outlet~
object performs an overlapped sum of the blocks computed in this window.
;
#X text 129 8 block~ object specifies vector size of 512 and overlap
four. This window now computes blocks of 512 samples at intervals of
128 samples computed on the parent patch.;
#X obj 36 140 tabreceive~ hann;
#X obj 13 383 sqrt~;
#X obj 103 389 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 103 356 loadbang;
#X obj 14 273 *~;
#X obj 46 273 *~;
#X obj 103 409 metro 40;
#X obj 14 448 tabwrite~ \$0-fft;
#X obj 14 7 block~ 128 4;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 2 0 16 0;
#X connect 2 0 16 1;
#X connect 2 1 17 0;
#X connect 2 1 17 1;
#X connect 12 0 0 1;
#X connect 13 0 19 0;
#X connect 14 0 18 0;
#X connect 15 0 14 0;
#X connect 16 0 13 0;
#X connect 17 0 13 0;
#X connect 18 0 19 0;
#X restore 168 189 pd fft-analysis;
#X text 311 266 (((x-50)*0.1)*10 -50)/100 +1;
#X text 315 288 ((0.1x -5)*10 - 50)/100 + 1;
#X text 314 308 (x-100)/100 + 1;
#X msg 542 319 0.01;
#X text 316 329 0.01x;
#X floatatom 342 533 5 0 0 0 - - -;
#X obj 464 590 + 0;
#X obj 295 444 unpack f f f;
#X obj 295 571 pack f f f;
#X floatatom 382 474 5 0 0 0 - - -;
#X obj 508 434 pack 32 0 32;
#X obj 493 56 table \$0-fftfin 32;
#X obj 394 533 t b f;
#X obj 295 394 pipe 10;
#X obj 559 525 loadbang;
#X obj 559 547 f \$1;
#X obj 559 569 sel 0;
#X msg 559 591 70;
#X obj 104 133 delwrite~ \$0-local 300;
#X obj 167 169 delread~ \$0-local 90;
#X connect 0 0 4 0;
#X connect 1 0 13 0;
#X connect 1 0 38 0;
#X connect 1 0 71 0;
#X connect 1 1 4 0;
#X connect 4 0 5 0;
#X connect 5 0 1 0;
#X connect 6 0 63 0;
#X connect 6 2 56 0;
#X connect 6 3 2 0;
#X connect 11 0 6 0;
#X connect 13 0 10 0;
#X connect 14 0 35 0;
#X connect 14 0 35 1;
#X connect 16 0 66 0;
#X connect 17 0 19 0;
#X connect 18 0 9 0;
#X connect 18 0 24 0;
#X connect 18 0 61 0;
#X connect 19 0 15 0;
#X connect 20 0 26 1;
#X connect 20 0 40 1;
#X connect 21 0 22 0;
#X connect 22 0 59 0;
#X connect 23 0 20 0;
#X connect 24 0 21 0;
#X connect 24 1 22 1;
#X connect 25 0 26 0;
#X connect 26 0 27 0;
#X connect 27 0 28 0;
#X connect 27 0 30 0;
#X connect 28 0 29 0;
#X connect 28 1 34 0;
#X connect 29 0 31 0;
#X connect 29 0 32 0;
#X connect 32 0 33 0;
#X connect 33 0 36 0;
#X connect 34 0 14 0;
#X connect 35 0 13 1;
#X connect 36 0 14 0;
#X connect 38 0 37 0;
#X connect 39 0 49 0;
#X connect 39 0 49 1;
#X connect 40 0 41 0;
#X connect 41 0 42 0;
#X connect 41 0 44 0;
#X connect 42 0 43 0;
#X connect 42 1 48 0;
#X connect 43 0 45 0;
#X connect 43 0 46 0;
#X connect 46 0 47 0;
#X connect 47 0 50 0;
#X connect 48 0 39 0;
#X connect 49 0 38 1;
#X connect 50 0 39 0;
#X connect 51 0 40 0;
#X connect 56 0 3 0;
#X connect 58 0 9 1;
#X connect 58 0 61 1;
#X connect 58 0 65 0;
#X connect 59 0 23 0;
#X connect 60 0 18 0;
#X connect 60 2 62 0;
#X connect 61 0 17 0;
#X connect 62 0 61 2;
#X connect 62 0 9 2;
#X connect 63 0 12 0;
#X connect 65 0 21 0;
#X connect 65 1 59 1;
#X connect 66 0 60 0;
#X connect 67 0 68 0;
#X connect 68 0 69 0;
#X connect 69 0 70 0;
#X connect 70 0 58 0;
#X connect 72 0 52 0;
